import{q as u,r as n,a as b,j as s,$ as N}from"./app-CzxKle0n.js";import{A as f}from"./AuthenticatedLayout-2tqRglK4.js";import{c as g}from"./index-BvR7Rk9I.js";import"./Actif-CW2ogQt8.js";function D({venteId:r,show:c,onClose:i}){var m,h,j;const{props:t}=u(),[e,x]=n.useState(null),[a,o]=n.useState(!1);n.useEffect(()=>{c&&r&&p()},[c,r]);const p=async()=>{o(!0);try{const l=await b.get(`/laventes/${r}/details`);x(l.data.vente)}catch(l){g.error("Erreur lors du chargement des détails"),console.error(l)}finally{o(!1)}};return s.jsxs("dialog",{open:c,className:"modal modal-bottom sm:modal-middle bg-base-100",children:[s.jsxs("div",{className:"modal-box max-w-5xl bg-base-100",children:[a?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx("span",{className:"loading loading-spinner loading-lg"})}):s.jsxs(s.Fragment,{children:[s.jsxs("h3",{className:"font-bold text-xl mb-4",children:["Détails de la Vente #",e==null?void 0:e.code]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Client:"})," ",((m=e==null?void 0:e.client)==null?void 0:m.name)||"Non spécifié"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Date:"})," ",new Date(e==null?void 0:e.created_at).toLocaleString()]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Total:"})," ",e==null?void 0:e.montant_total," ",t.currency||"CDF"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold",children:"Statut:"}),s.jsx("span",{className:`badge ml-2 ${(e==null?void 0:e.statut)==="payé"?"badge-success":"badge-warning"}`,children:e==null?void 0:e.statut})]})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"table table-zebra",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Produit"}),s.jsx("th",{className:"text-right",children:"Qté"}),s.jsx("th",{className:"text-right",children:"Prix Unitaire"}),s.jsx("th",{className:"text-right",children:"Total"})]})}),s.jsx("tbody",{children:(h=e==null?void 0:e.articles)==null?void 0:h.map(l=>{var d;return s.jsxs("tr",{children:[s.jsx("td",{children:(d=l.produit)==null?void 0:d.nom}),s.jsx("td",{className:"text-right",children:l.quantite}),s.jsxs("td",{className:"text-right",children:[l.prix_unitaire," ",t.currency||"CDF"]}),s.jsxs("td",{className:"text-right font-medium",children:[(l.quantite*l.prix_unitaire).toFixed(2)," ",t.currency||"CDF"]})]},l.id)})}),s.jsx("tfoot",{children:s.jsxs("tr",{children:[s.jsx("th",{colSpan:"3",children:"Total Général"}),s.jsxs("th",{className:"text-right",children:[(j=e==null?void 0:e.articles)==null?void 0:j.reduce((l,d)=>l+d.quantite*d.prix_unitaire,0).toFixed(2)," ",t.currency||"CDF"]})]})})]})})]}),s.jsx("div",{className:"modal-action",children:s.jsx("button",{onClick:i,className:"btn",children:"Fermer"})})]}),s.jsx("form",{method:"dialog",className:"modal-backdrop",children:s.jsx("button",{onClick:i,children:"fermer"})})]})}function F({recents:r}){const[c,i]=n.useState(null),[t,e]=n.useState(!1),x=a=>{i(a),e(!0)};return s.jsxs(f,{children:[s.jsx(N,{title:"Activités"}),r.map((a,o)=>s.jsxs("div",{className:"collapse collapse-arrow bg-base-100 border border-base-300",children:[s.jsx("input",{type:"radio",name:"my-accordion-2",defaultChecked:!0}),s.jsx("div",{className:"collapse-title font-semibold",children:a.user}),s.jsxs("div",{className:"collapse-content text-sm",children:[s.jsxs("div",{className:"flex gap-3 it",children:[s.jsx("div",{className:"avatar avatar-placeholder",children:s.jsx("div",{className:`bg-${a.color} text-${a.color}-content w-16 rounded-full items-center`,children:s.jsx("span",{className:"text-xl",children:a.type})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:a.description}),s.jsxs("p",{className:"text-xs opacity-70",children:[a.date," • ",a.user]}),a.type=="vente"&&s.jsx("button",{onClick:()=>x(a.id),className:"btn btn-sm btn-info mt-2",children:"Détails"})]})]}),s.jsx(D,{venteId:c,show:t,onClose:()=>e(!1)})]})]},o))]})}export{F as default};
