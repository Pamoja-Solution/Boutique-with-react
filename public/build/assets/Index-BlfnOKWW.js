import{r as o,v as x,j as e,$ as g,Y as w}from"./app-Dqwb8NiN.js";import{A as C}from"./AuthenticatedLayout-DKlr-RLT.js";import{P as y}from"./PrimaryButton-DCIVRcAC.js";import{D}from"./DangerButton-D1TyxTvY.js";import{T as i,I as l}from"./TextInput-g_E9u0Fh.js";import{I as t}from"./InputLabel-Bjes9kFZ.js";import"./Dropdown-CuCFgTtY.js";import"./Actif-DAhVwEZZ.js";import"./index-CC_my2GX.js";function L({auth:n,users:h,roles:p}){const[j,d]=o.useState(!1),[S,_]=o.useState(!1),[f,m]=o.useState(!1),[r,v]=o.useState(null),a=x({name:"",email:"",password:"",password_confirmation:"",role_id:"",photo:null}),c=x({name:"",email:"",password:"",password_confirmation:"",role_id:"",photo:null,_method:"PUT"}),b=s=>{s.preventDefault(),a.post(route("users.store"),{onSuccess:()=>{d(!1),a.reset()}})},N=()=>{c.delete(route("users.destroy",r.id),{onSuccess:()=>{m(!1),v(null)}})};return e.jsxs(C,{user:n.user,header:e.jsx("h2",{className:"font-semibold text-xl text-base-content leading-tight",children:"Gestion des utilisateurs"}),children:[e.jsx(g,{title:"Gestion des utilisateurs"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-base-100 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Liste des utilisateurs"}),e.jsx("button",{onClick:()=>d(!0),className:"btn btn-primary",children:"Ajouter un utilisateur"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Nom"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Rôle"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:h.map(s=>{var u;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.photo&&e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-10 rounded-full",children:e.jsx("img",{src:`${s.photo}`,alt:s.name})})}),e.jsx("div",{children:e.jsx("div",{className:"font-bold",children:s.name})})]})}),e.jsx("td",{children:s.email}),e.jsx("td",{children:((u=s.role)==null?void 0:u.name)||"Aucun rôle"}),e.jsxs("td",{className:"flex gap-2",children:[e.jsx(w,{href:route("users.edit",s.id),className:"btn btn-sm btn-ghost",children:"Modifier"}),e.jsx("button",{onClick:()=>openDeleteModal(s),className:"btn btn-sm btn-error",children:"Supprimer"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.is_active?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-green-600",children:"Actif"}),n.user.permissions.users.delete&&e.jsx("button",{onClick:()=>handleDeactivate(s.id),className:"ml-2 text-red-600 hover:text-red-800",children:"Désactiver"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-red-600",children:"Inactif "}),n.user.permissions.users.restore&&e.jsx("button",{onClick:()=>handleActivate(s.id),className:"ml-2 text-green-600 hover:text-green-800",children:"Réactiver"})]})})]},s.id)})})]})})]})})})}),e.jsx("dialog",{open:j,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Ajouter un nouvel utilisateur"}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"form-control w-full mb-4",children:[e.jsx(t,{htmlFor:"name",value:"Nom complet"}),e.jsx(i,{id:"name",type:"text",className:"input input-bordered w-full",value:a.data.name,onChange:s=>a.setData("name",s.target.value),required:!0}),e.jsx(l,{message:a.errors.name,className:"mt-1"})]}),e.jsxs("div",{className:"form-control w-full mb-4",children:[e.jsx(t,{htmlFor:"email",value:"Email"}),e.jsx(i,{id:"email",type:"email",className:"input input-bordered w-full",value:a.data.email,onChange:s=>a.setData("email",s.target.value),required:!0}),e.jsx(l,{message:a.errors.email,className:"mt-1"})]}),e.jsxs("div",{className:"form-control w-full mb-4",children:[e.jsx(t,{htmlFor:"password",value:"Mot de passe"}),e.jsx(i,{id:"password",type:"password",className:"input input-bordered w-full",value:a.data.password,onChange:s=>a.setData("password",s.target.value),required:!0}),e.jsx(l,{message:a.errors.password,className:"mt-1"})]}),e.jsxs("div",{className:"form-control w-full mb-4",children:[e.jsx(t,{htmlFor:"password_confirmation",value:"Confirmation mot de passe"}),e.jsx(i,{id:"password_confirmation",type:"password",className:"input input-bordered w-full",value:a.data.password_confirmation,onChange:s=>a.setData("password_confirmation",s.target.value),required:!0})]}),e.jsxs("div",{className:"form-control w-full mb-4",children:[e.jsx(t,{htmlFor:"role_id",value:"Rôle"}),e.jsxs("select",{id:"role_id",className:"select select-bordered w-full",value:a.data.role_id,onChange:s=>a.setData("role_id",s.target.value),children:[e.jsx("option",{value:"",children:"Sélectionner un rôle"}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(l,{message:a.errors.role_id,className:"mt-1"})]}),e.jsxs("div",{className:"form-control w-full mb-6",children:[e.jsx(t,{htmlFor:"photo",value:"Photo de profil"}),e.jsx("input",{type:"file",id:"photo",className:"file-input file-input-bordered w-full",onChange:s=>a.setData("photo",s.target.files[0])}),e.jsx(l,{message:a.errors.photo,className:"mt-1"})]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{d(!1),a.reset()},children:"Annuler"}),e.jsx(y,{type:"submit",disabled:a.processing,children:a.processing?"Création...":"Créer"})]})]})]})}),e.jsx("dialog",{open:f,className:"modal",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg mb-3",children:"Confirmer la suppression"}),e.jsxs("p",{children:["Êtes-vous sûr de vouloir supprimer l'utilisateur ",r==null?void 0:r.name," ?"]}),e.jsx("p",{className:"text-red-500 text-center font-bold mt-2",children:"Il serait mieux de le desactiver car toutes les données lui concernant seront aussi supprimer"}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>m(!1),children:"Annuler"}),e.jsx(D,{onClick:N,disabled:c.processing,children:c.processing?"Suppression...":"Supprimer"})]})]})})]})}export{L as default};
