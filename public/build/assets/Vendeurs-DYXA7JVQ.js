import{r as c,j as s,$ as _,m as f}from"./app-C6qsucit.js";import{A as M}from"./AuthenticatedLayout-BrYi9gUq.js";import{a as D,s as L,e as R}from"./startOfMonth-BdyWSODo.js";import{f as a}from"./format-Fr-isxMl.js";import{f as w}from"./fr-CVdFLKdr.js";import"./Actif-Bm8v4DiL.js";import"./index-Bk9xLtwu.js";function A(x,g,n){return D(x,-1,n)}function H({auth:x,vendeurs:g,selectedVendeur:n,ventes:y,stats:d,filters:j}){const[l,C]=c.useState(j.periode||"today"),[r,o]=c.useState(j.date_debut||a(new Date,"yyyy-MM-dd")),[u,m]=c.useState(j.date_fin||a(new Date,"yyyy-MM-dd")),[t,k]=c.useState(null),[F,b]=c.useState(!1),h=e=>{C(e);const i=new Date;switch(e){case"today":o(a(i,"yyyy-MM-dd")),m(a(i,"yyyy-MM-dd"));break;case"yesterday":const v=A(i);o(a(v,"yyyy-MM-dd")),m(a(v,"yyyy-MM-dd"));break;case"month":o(a(L(i),"yyyy-MM-dd")),m(a(R(i),"yyyy-MM-dd"));break}p(e)},p=(e=l)=>{if(!n)return;const i={vendeur_id:n.id,periode:e};e==="custom"&&(i.date_debut=r,i.date_fin=u),f.get(route("stats.vendeurs"),i,{preserveState:!0,replace:!0})},S=e=>{f.get(route("stats.vendeurs"),{vendeur_id:e.id,periode:l,date_debut:l==="custom"?r:void 0,date_fin:l==="custom"?u:void 0},{preserveState:!0,replace:!0})},T=e=>{k(e),b(!0)},N=e=>{window.open(`http://127.0.0.1:8000/ventes/${e}/ticket`,"_blank")};return s.jsxs(M,{user:x.user,header:s.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"Statistiques des Vendeurs"}),children:[s.jsx(_,{title:"Statistiques des Vendeurs"}),s.jsx("div",{className:"py-6 px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"lg:col-span-1 bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"Liste des Vendeurs"}),s.jsx("div",{className:"space-y-2",children:g.map(e=>s.jsx("div",{className:`p-1 rounded-lg cursor-pointer overflow-hidden transition-colors ${(n==null?void 0:n.id)===e.id?"bg-primary text-primary-content":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,onClick:()=>S(e),children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"avatar",children:s.jsx("div",{className:"w-10 rounded-full",children:s.jsx("img",{src:e.photo||"/images/default-avatar.png",alt:e.name})})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-sm",children:e.name}),s.jsx("p",{className:" opacity-70 text-xs",children:e.email})]})]})},e.id))})]}),s.jsx("div",{className:"lg:col-span-3 space-y-6",children:n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:"Filtrer les ventes"}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("button",{className:`btn ${l==="today"?"btn-primary":"btn-ghost"}`,onClick:()=>h("today"),children:"Aujourd'hui"}),s.jsx("button",{className:`btn ${l==="yesterday"?"btn-primary":"btn-ghost"}`,onClick:()=>h("yesterday"),children:"Hier"}),s.jsx("button",{className:`btn ${l==="month"?"btn-primary":"btn-ghost"}`,onClick:()=>h("month"),children:"Ce mois"}),s.jsx("button",{className:`btn ${l==="custom"?"btn-primary":"btn-ghost"}`,onClick:()=>h("custom"),children:"Personnalisé"}),l==="custom"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"date",className:"input input-bordered",value:r,onChange:e=>{o(e.target.value),p()}}),s.jsx("span",{children:"à"}),s.jsx("input",{type:"date",className:"input input-bordered",value:u,onChange:e=>{m(e.target.value),p()},min:r})]})]})]}),d&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx("div",{className:"stats bg-primary text-primary-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total Ventes"}),s.jsx("div",{className:"stat-value",children:d.total_ventes})]})}),s.jsx("div",{className:"stats bg-secondary text-secondary-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total HT"}),s.jsxs("div",{className:"stat-value text-xl",children:[d.total_ht.toLocaleString("fr-FR")," FC"]})]})}),s.jsx("div",{className:"stats bg-accent text-accent-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total TVA"}),s.jsxs("div",{className:"stat-value text-xl",children:[d.total_tva.toLocaleString("fr-FR")," FC"]})]})}),s.jsx("div",{className:"stats bg-neutral text-neutral-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total TTC"}),s.jsxs("div",{className:"stat-value text-xl",children:[d.total_ttc.toLocaleString("fr-FR")," FC"]})]})})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"table w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Client"}),s.jsx("th",{children:"Total TTC"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:y.length>0?y.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:a(new Date(e.created_at),"PPpp",{locale:w})}),s.jsx("td",{children:e.client.name}),s.jsxs("td",{children:[e.total_ttc.toLocaleString("fr-FR")," FC"]}),s.jsxs("td",{className:"flex space-x-2",children:[s.jsx("button",{className:"btn btn-sm btn-info",onClick:()=>T(e),children:"Détails"}),s.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>N(e.id),children:"Imprimer"})]})]},e.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"text-center py-4",children:"Aucune vente trouvée pour cette période"})})})]})})})]}):s.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow rounded-lg p-8 text-center",children:[s.jsx("div",{className:"text-2xl font-medium mb-2",children:"Sélectionnez un vendeur"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Veuillez sélectionner un vendeur dans la liste pour afficher ses statistiques"})]})})]})})}),F&&t&&s.jsx("div",{className:"modal modal-open",children:s.jsxs("div",{className:"modal-box max-w-4xl",children:[s.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Détails de la vente #",t.code,s.jsx("span",{className:"ml-2 badge badge-primary",children:a(new Date(t.created_at),"PPpp",{locale:w})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"Informations client"}),s.jsxs("div",{className:"bg-base-200 p-4 rounded-lg",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Nom:"})," ",t.client.name]}),t.client.phone&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Téléphone:"})," ",t.client.phone]}),t.client.email&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Email:"})," ",t.client.email]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"Totaux"}),s.jsxs("div",{className:"bg-base-200 p-4 rounded-lg",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Total HT:"})," ",t.total_ht.toLocaleString("fr-FR")," FC"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Total TVA:"})," ",t.total_tva.toLocaleString("fr-FR")," FC"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Total TTC:"})," ",t.total_ttc.toLocaleString("fr-FR")," FC"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Remise:"})," ",t.remise,"%"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Montant payé:"})," ",t.montant_paye.toLocaleString("fr-FR")," FC"]})]})]})]}),s.jsx("h4",{className:"font-medium mb-2",children:"Articles vendus"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"table w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Produit"}),s.jsx("th",{children:"Quantité"}),s.jsx("th",{children:"Prix unitaire"}),s.jsx("th",{children:"TVA"}),s.jsx("th",{children:"Total"})]})}),s.jsx("tbody",{children:t.articles.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"avatar",children:s.jsx("div",{className:"mask mask-squircle w-12 h-12",children:s.jsx("img",{src:e.produit.image||"/images/default-product.png",alt:e.produit.nom})})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold",children:e.produit.nom}),s.jsx("div",{className:"text-sm opacity-50",children:e.produit.code})]})]})}),s.jsx("td",{children:e.quantite}),s.jsxs("td",{children:[e.prix_unitaire.toLocaleString("fr-FR")," FC"]}),s.jsxs("td",{children:[e.taux_tva,"%"]}),s.jsxs("td",{children:[e.montant_ttc.toLocaleString("fr-FR")," FC"]})]},e.id))})]})}),s.jsxs("div",{className:"modal-action",children:[s.jsx("button",{className:"btn btn-success",onClick:()=>N(t.id),children:"Imprimer le ticket"}),s.jsx("button",{className:"btn",onClick:()=>b(!1),children:"Fermer"})]})]})})]})}export{H as default};
