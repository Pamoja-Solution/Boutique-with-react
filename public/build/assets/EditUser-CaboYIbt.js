import{r as u,v as b,j as e,$ as y,Y as h}from"./app-BGCwe7YQ.js";import{A as _}from"./AuthenticatedLayout-iZMU9qq1.js";import{P as C}from"./PrimaryButton-CGpPUd9R.js";import{T as m,I as d}from"./TextInput-STnDYLSl.js";import{I as l}from"./InputLabel-BpqD5lZg.js";import"./Dropdown-CwZ0mvGO.js";import"./Actif-CCAzDc6_.js";import"./index-BWb_JfMf.js";function S({auth:x,user:t,roles:f}){const n=u.useRef(null),{data:a,setData:o,post:g,errors:i,processing:p,recentlySuccessful:j}=b({name:t.name,email:t.email,password:"",password_confirmation:"",role_id:t.role_id,photo:null,_method:"PUT"}),[v,c]=u.useState(t.photo?`${t.photo}`:"/images/default-avatar.png"),N=s=>{const r=s.target.files[0];r?(o("photo",r),c(URL.createObjectURL(r))):(o("photo",null),c(t.photo?`${t.photo}`:"/images/default-avatar.png"))},w=s=>{s.preventDefault();const r=new FormData;r.append("_method","PUT"),r.append("name",a.name),r.append("email",a.email),r.append("role_id",a.role_id||""),a.password&&(r.append("password",a.password),r.append("password_confirmation",a.password_confirmation)),a.photo instanceof File&&r.append("photo",a.photo),g(route("users.update",t.id),{data:r,preserveScroll:!0,onError:()=>{n.current&&(n.current.value="")}})};return e.jsxs(_,{user:x.user,header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"font-semibold text-xl text-base-content leading-tight",children:["Modifier ",t.name]}),e.jsx(h,{href:route("users.index"),className:"btn btn-ghost",children:"Retour à la liste"})]}),children:[e.jsx(y,{title:`Modifier ${t.name}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-3xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-base-100 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-8",children:[j&&e.jsxs("div",{className:"alert alert-success mb-6",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Modifications enregistrées avec succès!"})]}),e.jsxs("form",{onSubmit:w,encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"form-control",children:[e.jsx(l,{htmlFor:"name",value:"Nom complet *"}),e.jsx(m,{id:"name",type:"text",className:"input input-bordered w-full",value:a.name,onChange:s=>o("name",s.target.value),required:!0}),e.jsx(d,{message:i.name,className:"mt-1"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx(l,{htmlFor:"email",value:"Email *"}),e.jsx(m,{id:"email",type:"email",className:"input input-bordered w-full",value:a.email,onChange:s=>o("email",s.target.value),required:!0}),e.jsx(d,{message:i.email,className:"mt-1"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx(l,{htmlFor:"role_id",value:"Rôle"}),e.jsxs("select",{id:"role_id",className:"select select-bordered w-full",value:a.role_id,onChange:s=>o("role_id",s.target.value),children:[e.jsx("option",{value:"",children:"Sélectionner un rôle"}),f.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx(d,{message:i.role_id,className:"mt-1"})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"form-control",children:[e.jsx(l,{value:"Photo de profil"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"avatar mb-4",children:e.jsx("div",{className:"w-32 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2",children:e.jsx("img",{src:v,alt:"Photo de profil",onError:s=>{s.target.src="/images/default-avatar.png"}})})}),e.jsxs("label",{className:"btn btn-outline",children:[a.photo instanceof File?"Photo sélectionnée":"Changer la photo",e.jsx("input",{type:"file",ref:n,className:"hidden",onChange:N,accept:"image/*"})]}),a.photo instanceof File&&e.jsx("button",{type:"button",className:"btn btn-primary btn-xs mt-2",onClick:()=>{o("photo",null),c(t.photo?`/storage/${t.photo}`:"/images/default-avatar.png"),n.current&&(n.current.value="")},children:"Annuler la sélection"}),e.jsx(d,{message:i.photo,className:"mt-2"})]})]})})]}),e.jsxs("div",{className:"mt-8 p-6 bg-base-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Changer le mot de passe"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx(l,{htmlFor:"password",value:"Nouveau mot de passe"}),e.jsx(m,{id:"password",type:"password",className:"input input-bordered w-full",value:a.password,onChange:s=>o("password",s.target.value)}),e.jsx(d,{message:i.password,className:"mt-1"})]}),e.jsxs("div",{className:"form-control",children:[e.jsx(l,{htmlFor:"password_confirmation",value:"Confirmation"}),e.jsx(m,{id:"password_confirmation",type:"password",className:"input input-bordered w-full",value:a.password_confirmation,onChange:s=>o("password_confirmation",s.target.value)})]})]})]}),e.jsxs("div",{className:"flex justify-end mt-8 space-x-4",children:[e.jsx(h,{href:route("users.index"),className:"btn btn-ghost",children:"Annuler"}),e.jsx(C,{type:"submit",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner"}),"Enregistrement..."]}):"Enregistrer les modifications"})]})]})]})})})})]})}export{S as default};
