import{r as c,j as s,$ as M,m as f}from"./app-CFD2f151.js";import{A as k}from"./AuthenticatedLayout-Ddn20-Xk.js";import{a as D,s as L,e as R}from"./startOfMonth-BdyWSODo.js";import{f as a}from"./format-Fr-isxMl.js";import{f as C}from"./fr-CVdFLKdr.js";import"./Actif-BSdadqrY.js";import"./index-B9tAU3jH.js";function A(h,b,d){return D(h,-1,d)}function E({auth:h,vendeurs:b,selectedVendeur:d,ventes:N,stats:n,filters:j}){const[l,F]=c.useState(j.periode||"today"),[r,o]=c.useState(j.date_debut||a(new Date,"yyyy-MM-dd")),[u,m]=c.useState(j.date_fin||a(new Date,"yyyy-MM-dd")),[t,w]=c.useState(null),[S,v]=c.useState(!1),x=e=>{F(e);const i=new Date;switch(e){case"today":o(a(i,"yyyy-MM-dd")),m(a(i,"yyyy-MM-dd"));break;case"yesterday":const g=A(i);o(a(g,"yyyy-MM-dd")),m(a(g,"yyyy-MM-dd"));break;case"month":o(a(L(i),"yyyy-MM-dd")),m(a(R(i),"yyyy-MM-dd"));break}p(e)},p=(e=l)=>{if(!d)return;const i={vendeur_id:d.id,periode:e};e==="custom"&&(i.date_debut=r,i.date_fin=u),f.get(route("stats.vendeurs"),i,{preserveState:!0,replace:!0})},T=e=>{f.get(route("stats.vendeurs"),{vendeur_id:e.id,periode:l,date_debut:l==="custom"?r:void 0,date_fin:l==="custom"?u:void 0},{preserveState:!0,replace:!0})},_=e=>{w(e),v(!0)},y=e=>{window.open(`http://127.0.0.1:8000/ventes/${e}/ticket`,"_blank")};return s.jsxs(k,{user:h.user,header:s.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"Statistiques des Vendeurs"}),children:[s.jsx(M,{title:"Statistiques des Vendeurs"}),s.jsx("div",{className:"px-4 py-6 sm:px-6 lg:px-8",children:s.jsx("div",{className:"mx-auto max-w-7xl",children:s.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-4",children:[s.jsx("div",{className:"card bg-base-100 shadow-xl lg:col-span-1",children:s.jsxs("div",{className:"card-body",children:[s.jsx("h3",{className:"mb-4 text-lg font-medium card-title",children:"Liste des Vendeurs"}),s.jsx("div",{className:"space-y-2",children:b.map(e=>s.jsx("div",{className:`cursor-pointer overflow-hidden rounded-lg p-1 transition-colors ${(d==null?void 0:d.id)===e.id?"bg-primary text-primary-content":"hover:bg-base-200"}`,onClick:()=>T(e),children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"avatar",children:s.jsx("div",{className:"w-10 rounded-full",children:s.jsx("img",{src:e.photo||"/images/default-avatar.png",alt:e.name})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:e.name}),s.jsx("p",{className:"text-xs opacity-70",children:e.email})]})]})},e.id))})]})}),s.jsx("div",{className:"space-y-6 lg:col-span-3",children:d?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"card bg-base-100 shadow-xl",children:s.jsxs("div",{className:"card-body",children:[s.jsx("h3",{className:"mb-4 text-lg font-medium card-title",children:"Filtrer les ventes"}),s.jsxs("div",{className:"flex flex-wrap gap-4",children:[s.jsx("button",{className:`btn ${l==="today"?"btn-primary":"btn-ghost"}`,onClick:()=>x("today"),children:"Aujourd'hui"}),s.jsx("button",{className:`btn ${l==="yesterday"?"btn-primary":"btn-ghost"}`,onClick:()=>x("yesterday"),children:"Hier"}),s.jsx("button",{className:`btn ${l==="month"?"btn-primary":"btn-ghost"}`,onClick:()=>x("month"),children:"Ce mois"}),s.jsx("button",{className:`btn ${l==="custom"?"btn-primary":"btn-ghost"}`,onClick:()=>x("custom"),children:"Personnalisé"}),l==="custom"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"date",className:"input input-bordered",value:r,onChange:e=>{o(e.target.value),p()}}),s.jsx("span",{children:"à"}),s.jsx("input",{type:"date",className:"input input-bordered",value:u,onChange:e=>{m(e.target.value),p()},min:r})]})]})]})}),n&&s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[s.jsx("div",{className:"stats bg-primary text-primary-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total Ventes"}),s.jsx("div",{className:"stat-value",children:n.total_ventes})]})}),s.jsx("div",{className:"stats bg-secondary text-secondary-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total HT"}),s.jsxs("div",{className:"stat-value text-xl",children:[n.total_ht.toLocaleString("fr-FR")," FC"]})]})}),s.jsx("div",{className:"stats bg-accent text-accent-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total TVA"}),s.jsxs("div",{className:"stat-value text-xl",children:[n.total_tva.toLocaleString("fr-FR")," FC"]})]})}),s.jsx("div",{className:"stats bg-neutral text-neutral-content shadow",children:s.jsxs("div",{className:"stat",children:[s.jsx("div",{className:"stat-title",children:"Total TTC"}),s.jsxs("div",{className:"stat-value text-xl",children:[n.total_ttc.toLocaleString("fr-FR")," FC"]})]})})]}),s.jsx("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:s.jsx("div",{className:"card-body p-0",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"table table-zebra w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Date"}),s.jsx("th",{children:"Client"}),s.jsx("th",{children:"Total TTC"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:N.length>0?N.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:a(new Date(e.created_at),"PPpp",{locale:C})}),s.jsx("td",{children:e.client.name}),s.jsxs("td",{children:[e.total_ttc.toLocaleString("fr-FR")," FC"]}),s.jsxs("td",{className:"flex space-x-2",children:[s.jsx("button",{className:"btn btn-info btn-sm",onClick:()=>_(e),children:"Détails"}),s.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>y(e.id),children:"Imprimer"})]})]},e.id)):s.jsx("tr",{children:s.jsx("td",{colSpan:"4",className:"py-4 text-center",children:"Aucune vente trouvée pour cette période"})})})]})})})})]}):s.jsx("div",{className:"card bg-base-100 shadow-xl",children:s.jsxs("div",{className:"card-body text-center",children:[s.jsx("div",{className:"mb-2 text-2xl font-medium",children:"Sélectionnez un vendeur"}),s.jsx("p",{className:"text-base-content/60",children:"Veuillez sélectionner un vendeur dans la liste pour afficher ses statistiques"})]})})})]})})}),S&&t&&s.jsx("div",{className:"modal modal-open",children:s.jsxs("div",{className:"modal-box max-w-4xl",children:[s.jsxs("h3",{className:"mb-4 text-lg font-bold",children:["Détails de la vente #",t.code,s.jsx("span",{className:"ml-2 badge badge-primary",children:a(new Date(t.created_at),"PPpp",{locale:C})})]}),s.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 md:grid-cols-2",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"mb-2 font-medium",children:"Informations client"}),s.jsxs("div",{className:"rounded-lg bg-base-200 p-4",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Nom:"})," ",t.client.name]}),t.client.phone&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Téléphone:"})," ",t.client.phone]}),t.client.email&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Email:"})," ",t.client.email]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"mb-2 font-medium",children:"Totaux"}),s.jsxs("div",{className:"rounded-lg bg-base-200 p-4",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Total HT:"})," ",t.total_ht.toLocaleString("fr-FR")," FC"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Total TVA:"})," ",t.total_tva.toLocaleString("fr-FR")," FC"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Total TTC:"})," ",t.total_ttc.toLocaleString("fr-FR")," FC"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Remise:"})," ",t.remise,"%"]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Montant payé:"})," ",t.montant_paye.toLocaleString("fr-FR")," FC"]})]})]})]}),s.jsx("h4",{className:"mb-2 font-medium",children:"Articles vendus"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"table w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Produit"}),s.jsx("th",{children:"Quantité"}),s.jsx("th",{children:"Prix unitaire"}),s.jsx("th",{children:"TVA"}),s.jsx("th",{children:"Total"})]})}),s.jsx("tbody",{children:t.articles.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"avatar",children:s.jsx("div",{className:"mask mask-squircle h-12 w-12",children:s.jsx("img",{src:e.produit.image||"/images/default-product.png",alt:e.produit.nom})})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold",children:e.produit.nom}),s.jsx("div",{className:"text-sm opacity-50",children:e.produit.code})]})]})}),s.jsx("td",{children:e.quantite}),s.jsxs("td",{children:[e.prix_unitaire.toLocaleString("fr-FR")," FC"]}),s.jsxs("td",{children:[e.taux_tva,"%"]}),s.jsxs("td",{children:[e.montant_ttc.toLocaleString("fr-FR")," FC"]})]},e.id))})]})}),s.jsxs("div",{className:"modal-action",children:[s.jsx("button",{className:"btn btn-success",onClick:()=>y(t.id),children:"Imprimer le ticket"}),s.jsx("button",{className:"btn btn-error",onClick:()=>v(!1),children:"Fermer"})]})]})})]})}export{E as default};
