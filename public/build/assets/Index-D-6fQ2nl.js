import{q as p,r as i,j as e,$ as v,m as o}from"./app-CjJhekxX.js";import{A as f}from"./AuthenticatedLayout-DW8W5fkb.js";import{c as g}from"./index-DS0bKAAE.js";import{F as w}from"./PlusIcon-CQuh6bEX.js";import{F as _,a as y}from"./TrashIcon-ByuYox9Z.js";import"./Dropdown-BG2ozV6T.js";import"./Actif-D1ZtpRqs.js";function A({auth:t,categories:u,stats:l}){const{flash:C}=p().props,[a,r]=i.useState(null),[h,c]=i.useState(!1),[d,n]=i.useState(null);i.useEffect(()=>{if(a){const s=document.getElementById("edit_modal");s&&s.showModal()}},[a]);const m=(s,N)=>{s.preventDefault();const x=new FormData(s.target);N?o.post(`/categories/${a.id}`,{_method:"PUT",...Object.fromEntries(x)},{onSuccess:()=>{g.success("Catégorie Modifié avec succès"),document.getElementById("edit_modal").close(),r(null)}}):o.post("/categories",x,{onSuccess:()=>{document.getElementById("create_modal").close()}})},j=s=>{n(s),c(!0)},b=()=>{o.delete(`/categories/${d.id}`,{onSuccess:()=>{c(!1),n(null)}})};return e.jsxs(f,{user:t.user.user,children:[e.jsx(v,{title:"Gestion des catégories"}),e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Gestion des catégories"}),t.user.role==="admin"&&e.jsxs("button",{onClick:()=>document.getElementById("create_modal").showModal(),className:"btn btn-primary",children:[e.jsx(w,{className:"h-5 w-5 mr-1"}),"Nouvelle catégorie"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"stats shadow",children:e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-title",children:"Total catégories"}),e.jsx("div",{className:"stat-value",children:l.total_categories})]})}),e.jsx("div",{className:"stats shadow",children:e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-title",children:"Produits total"}),e.jsx("div",{className:"stat-value",children:l.total_produits})]})}),e.jsx("div",{className:"stats shadow",children:e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-title",children:"Moyenne produits"}),e.jsx("div",{className:"stat-value",children:Math.round(l.moyenne_produits)}),e.jsx("div",{className:"stat-desc",children:"par catégorie"})]})}),e.jsx("div",{className:"stats shadow",children:e.jsxs("div",{className:"stat",children:[e.jsx("div",{className:"stat-title",children:"Plus utilisée"}),e.jsx("div",{className:"stat-value text-lg",children:l.categorie_plus_utilisee||"Aucune"}),e.jsxs("div",{className:"stat-desc",children:[l.produits_categorie_plus_utilisee||0," produits"]})]})})]}),e.jsx("div",{className:"bg-base-100 rounded-box shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"table",children:e.jsx("tbody",{children:u.map(s=>e.jsxs("tr",{className:"hover",children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.description||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.produits_count>0?"badge-primary":"badge-ghost"}`,children:s.produits_count})}),e.jsx("td",{children:e.jsxs("div",{className:"flex space-x-2",children:[t.user.role==="admin"&&e.jsxs("button",{onClick:()=>r(s),className:"btn btn-sm btn-ghost",children:[e.jsx(_,{className:"h-4 w-4"}),"Modifier"]}),t.user.role==="admin"&&e.jsxs("button",{onClick:()=>j(s),className:"btn btn-sm btn-error",disabled:s.produits_count>0,children:[e.jsx(y,{className:"h-4 w-4"}),"Supprimer"]})]})})]},s.id))})})})}),e.jsxs("dialog",{id:"create_modal",className:"modal",children:[e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Nouvelle catégorie"}),e.jsx("div",{className:"divider"}),e.jsxs("form",{onSubmit:s=>m(s,!1),children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nom*"})}),e.jsx("input",{type:"text",name:"name",className:"input input-bordered w-full",required:!0})]}),e.jsxs("div",{className:"form-control mt-4",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Description"})}),e.jsx("textarea",{name:"description",className:"textarea textarea-bordered h-24"})]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",onClick:()=>document.getElementById("create_modal").close(),className:"btn btn-ghost",children:"Annuler"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Créer"})]})]})]}),e.jsx("form",{method:"dialog",className:"modal-backdrop",children:e.jsx("button",{children:"close"})})]}),a&&e.jsxs("dialog",{id:"edit_modal",className:"modal",children:[e.jsxs("div",{className:"modal-box",children:[e.jsxs("h3",{className:"font-bold text-lg",children:["Modifier ",a.name]}),e.jsx("div",{className:"divider"}),e.jsxs("form",{onSubmit:s=>m(s,!0),children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Nom*"})}),e.jsx("input",{type:"text",name:"name",defaultValue:a.name,className:"input input-bordered w-full",required:!0})]}),e.jsxs("div",{className:"form-control mt-4",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Description"})}),e.jsx("textarea",{name:"description",defaultValue:a.description||"",className:"textarea textarea-bordered h-24"})]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",onClick:()=>document.getElementById("edit_modal").close(),className:"btn btn-ghost",children:"Annuler"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Enregistrer"})]})]})]}),e.jsx("form",{method:"dialog",className:"modal-backdrop",children:e.jsx("button",{onClick:()=>r(null),children:"close"})})]}),h&&e.jsx("dialog",{open:!0,className:"modal modal-bottom sm:modal-middle",children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Confirmer la suppression"}),e.jsxs("p",{className:"py-4",children:['Êtes-vous sûr de vouloir supprimer la catégorie "',d==null?void 0:d.name,'" ?']}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{onClick:()=>c(!1),className:"btn btn-ghost",children:"Annuler"}),e.jsx("button",{onClick:b,className:"btn btn-error",children:"Supprimer"})]})]})})]})]})}export{A as default};
