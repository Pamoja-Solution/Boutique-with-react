import{q as p,r as o,R as b,j as e,$ as f,Y as N,m as d}from"./app-BvN2VGK2.js";import{A as v}from"./AuthenticatedLayout-CofPKvkG.js";import{P as y}from"./Pagination-CNAEPksZ.js";import{V as i}from"./index-CQxxDfE9.js";import"./Actif-CGR9bzdf.js";function E({auth:g,caisse:t,mouvements:c}){const{flash:r}=p().props,[x,n]=o.useState(!1),[l,a]=o.useState({type:"entree",montant:"",description:""});b.useEffect(()=>{r.success&&i.success(r.success),r.error&&i.error(r.error)},[r]);const m=s=>{s.preventDefault(),d.post(route("caisses.mouvements.store",t.id),l,{onSuccess:()=>{n(!1),a({type:"entree",montant:"",description:""})},onError:u=>{Object.values(u).forEach(j=>i.error(j))}})},h=s=>{confirm("Annuler ce mouvement ? Cette action est irréversible.")&&d.delete(route("caisses.mouvements.destroy",[t.id,s]),{preserveScroll:!0})};return e.jsxs(v,{children:[e.jsx(f,{title:`Mouvements - ${t.name}`}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Mouvements de caisse"}),e.jsxs("h2",{className:"text-xl",children:[t.name," - Solde: ",t.solde_actuel.toFixed(2)," ",t.devise.symbole]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(N,{href:route("caisses.index"),className:"btn btn-ghost",children:"Retour aux caisses"}),e.jsx("button",{onClick:()=>n(!0),className:"btn btn-primary",children:"Nouveau mouvement"})]})]}),e.jsx("dialog",{id:"mouvement_modal",className:`modal ${x?"modal-open":""}`,children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Ajouter un mouvement"}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"form-control w-full mt-4",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Type"})}),e.jsxs("select",{className:"select select-bordered w-full",value:l.type,onChange:s=>a({...l,type:s.target.value}),required:!0,children:[e.jsx("option",{value:"entree",children:"Entrée"}),e.jsx("option",{value:"sortie",children:"Sortie"})]})]}),e.jsxs("div",{className:"form-control w-full mt-4",children:[e.jsx("label",{className:"label",children:e.jsxs("span",{className:"label-text",children:["Montant (",t.devise.symbole,")"]})}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",className:"input input-bordered w-full",value:l.montant,onChange:s=>a({...l,montant:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-control w-full mt-4",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Description"})}),e.jsx("input",{type:"text",className:"input input-bordered w-full",value:l.description,onChange:s=>a({...l,description:s.target.value}),required:!0})]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>n(!1),children:"Annuler"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Enregistrer"})]})]})]})}),e.jsx("div",{className:"card bg-base-100 shadow",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Montant"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Utilisateur"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:c.data.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(s.created_at).toLocaleString()}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.type==="entree"?"badge-success":"badge-error"}`,children:s.type})}),e.jsxs("td",{className:s.type==="entree"?"text-success":"text-error",children:[s.type==="entree"?"+":"-",s.montant.toFixed(2)," ",t.devise.symbole]}),e.jsx("td",{children:s.description}),e.jsx("td",{children:s.user.name}),e.jsx("td",{children:e.jsx("button",{onClick:()=>h(s.id),className:"btn btn-sm btn-error",children:"Annuler"})})]},s.id))})]})}),e.jsx(y,{links:c.links})]})})]})]})}export{E as default};
