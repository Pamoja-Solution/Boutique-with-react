import{q as D,r as l,j as e,$ as S,m as n}from"./app-Dqwb8NiN.js";import{A as w}from"./AuthenticatedLayout-DKlr-RLT.js";import{P as M}from"./Pagination-DwoGRUh6.js";import"./Dropdown-CuCFgTtY.js";import"./Actif-DAhVwEZZ.js";import"./index-CC_my2GX.js";function I({depenses:m,devises:i,modesPaiement:x}){var j;const{auth:q}=D().props,[r,u]=l.useState(""),[N,c]=l.useState(!1),[f,d]=l.useState(!1),[p,h]=l.useState(null),[s,t]=l.useState({montant:"",devise_id:((j=i.find(a=>a.is_default))==null?void 0:j.id)||"",description:"",mode_paiement:"espece",beneficiaire:"",date_depense:new Date().toISOString().split("T")[0]}),v=a=>{a.preventDefault(),n.get("/depenses",{search:r},{preserveState:!0,replace:!0})},g=()=>{var a;c(!0),t({montant:"",devise_id:((a=i.find(o=>o.is_default))==null?void 0:a.id)||"",description:"",mode_paiement:"espece",beneficiaire:"",date_depense:new Date().toISOString().split("T")[0]})},_=a=>{h(a),t({montant:a.montant,devise_id:a.devise_id,description:a.description,mode_paiement:a.mode_paiement,beneficiaire:a.beneficiaire,date_depense:a.date_depense.split("T")[0]}),d(!0)},b=a=>{a.preventDefault(),p?n.put(`/depenses/${p.id}`,s,{onSuccess:()=>{d(!1),h(null)}}):n.post("/depenses",s,{onSuccess:()=>{c(!1)}})},y=a=>{confirm("Êtes-vous sûr de vouloir supprimer cette dépense ?")&&n.delete(`/depenses/${a}`)},C=(a,o)=>`${o.symbole} ${a.toFixed(2)}`;return e.jsxs(w,{children:[e.jsx(S,{title:"Gestion des Dépenses"}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Gestion des Dépenses"}),e.jsx("button",{onClick:g,className:"btn btn-primary",children:"Ajouter une Dépense"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("form",{onSubmit:v,className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Rechercher des dépenses...",className:"input input-bordered w-full max-w-xs",value:r,onChange:a=>u(a.target.value)}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Rechercher"}),r&&e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{u(""),n.get("/depenses")},children:"Réinitialiser"})]})}),e.jsx("div",{className:"overflow-x-auto shadow-lg",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Montant"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Mode Paiement"}),e.jsx("th",{children:"Bénéficiaire"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:m.data.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(a.date_depense).toLocaleDateString()}),e.jsx("td",{children:C(a.montant,a.devise)}),e.jsx("td",{children:a.description}),e.jsx("td",{className:"capitalize",children:a.mode_paiement.replace("_"," ")}),e.jsx("td",{children:a.beneficiaire||"-"}),e.jsxs("td",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_(a),className:"btn btn-sm btn-info",children:"Modifier"}),e.jsx("button",{onClick:()=>y(a.id),className:"btn btn-sm btn-error",children:"Supprimer"})]})]},a.id))})]})}),e.jsx(M,{links:m.links,className:"mt-6"}),e.jsx("div",{className:`modal ${N?"modal-open":""}`,children:e.jsxs("div",{className:"modal-box",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Ajouter une nouvelle dépense"}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Montant"})}),e.jsx("input",{type:"number",step:"0.01",className:"input input-bordered",value:s.montant,onChange:a=>t({...s,montant:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Devise"})}),e.jsx("select",{className:"select select-bordered",value:s.devise_id,onChange:a=>t({...s,devise_id:a.target.value}),required:!0,children:i.map(a=>e.jsxs("option",{value:a.id,children:[a.code," (",a.symbole,")"]},a.id))})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Description"})}),e.jsx("textarea",{className:"textarea textarea-bordered",value:s.description,onChange:a=>t({...s,description:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Mode de paiement"})}),e.jsx("select",{className:"select select-bordered",value:s.mode_paiement,onChange:a=>t({...s,mode_paiement:a.target.value}),required:!0,children:x.map(a=>e.jsx("option",{value:a,children:a.replace("_"," ")},a))})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Bénéficiaire (optionnel)"})}),e.jsx("input",{type:"text",className:"input input-bordered",value:s.beneficiaire,onChange:a=>t({...s,beneficiaire:a.target.value})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Date de la dépense"})}),e.jsx("input",{type:"date",className:"input input-bordered",value:s.date_depense,onChange:a=>t({...s,date_depense:a.target.value}),required:!0})]}),e.jsxs("div",{className:"modal-action",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>c(!1),children:"Annuler"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Enregistrer"})]})]})]})}),e.jsx("div",{className:`modal ${f?"modal-open":""}`,children:e.jsxs("div",{className:"modal-box max-w-2xl p-6 rounded-xl shadow-xl",children:[e.jsx("h3",{className:"font-bold text-xl mb-6 text-center",children:"Modifier la dépense"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text text-base me-6 ",children:"Montant"})}),e.jsx("input",{type:"number",step:"0.01",className:"input input-bordered",value:s.montant,onChange:a=>t({...s,montant:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text text-base me-6",children:"Devise"})}),e.jsx("select",{className:"select select-bordered",value:s.devise_id,onChange:a=>t({...s,devise_id:a.target.value}),required:!0,children:i.map(a=>e.jsxs("option",{value:a.id,children:[a.code," (",a.symbole,")"]},a.id))})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text text-base me-6",children:"Description"})}),e.jsx("textarea",{className:"textarea textarea-bordered",value:s.description,onChange:a=>t({...s,description:a.target.value}),required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text text-base me-6",children:"Mode de paiement"})}),e.jsx("select",{className:"select select-bordered",value:s.mode_paiement,onChange:a=>t({...s,mode_paiement:a.target.value}),required:!0,children:x.map(a=>e.jsx("option",{value:a,children:a.replace("_"," ")},a))})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text text-base me-6",children:"Bénéficiaire (optionnel)"})}),e.jsx("input",{type:"text",className:"input input-bordered",value:s.beneficiaire,onChange:a=>t({...s,beneficiaire:a.target.value})})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text text-base me-6",children:"Date de la dépense"})}),e.jsx("input",{type:"date",className:"input input-bordered",value:s.date_depense,onChange:a=>t({...s,date_depense:a.target.value}),required:!0})]}),e.jsxs("div",{className:"modal-action mt-6 flex justify-between",children:[e.jsx("button",{type:"button",className:"btn btn-outline",onClick:()=>d(!1),children:"Annuler"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Mettre à jour"})]})]})]})})]})]})}export{I as default};
